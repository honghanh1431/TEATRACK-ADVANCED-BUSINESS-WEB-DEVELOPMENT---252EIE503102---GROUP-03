<main>
  <div class="container">
    <p *ngIf="loadError" class="load-error">Không tải được thông tin sản phẩm. Vui lòng thử lại sau.</p>
    <div *ngIf="!product && !loadError" class="product-loading" aria-live="polite">
      <p>Đang tải thông tin sản phẩm...</p>
    </div>
    <div class="page-head" *ngIf="product">
      <section class="breadcrumb-banner">
        <h1 class="breadcrumb-title">{{ product.name }}</h1>
        <p class="breadcrumb-path">
          <a routerLink="/" (click)="scrollToTop()"> Trang chủ </a>
          / <a routerLink="/menu" (click)="scrollToTop()"> Menu thức uống </a> /
          <a [routerLink]="['/menu']" [queryParams]="{ category: product.category }" (click)="scrollToTop()">{{ product.category }}</a>
        </p>
      </section>
    </div>

    <section class="product-detail" id="product-detail" aria-live="polite" *ngIf="product">
      <div class="detail-card">
        <div>
          <div class="media-frame">
            <button class="nav-arrow nav-prev" aria-label="Ảnh trước">‹</button>
            <img class="main-img" [src]="productImage" [alt]="product.name || 'Ảnh sản phẩm'" />
            <button class="nav-arrow nav-next" aria-label="Ảnh kế">›</button>
          </div>
          <div class="thumbs">
            <img class="thumb active" [src]="productImage" [alt]="product.name || 'thumb'" />
          </div>
        </div>
        <div class="info">
          <div class="cat" id="prod-cat">{{ product.category }}</div>
          <h2 class="name" id="prod-name">{{ product.name }}</h2>
          <div class="stars"><span class="fill" [style.width.%]="ratingPct"></span></div>
          <span class="rating-text" id="prod-rating-text">{{ (product.rating ?? 5) | number:'1.1-1' }} ({{ product.reviews ?? 0 }} lượt đánh giá)</span>

          <div class="promo">
            <div class="title">Ưu đãi đặc biệt</div>
            <ul>
              <li>Mua 5 tặng 1</li>
              <li>
                Mua 1 ly size L hoặc 2 ly size M được 1 dấu tích điểm, 8 dấu = 1 ly nước trị giá
                16.000đ
              </li>
            </ul>
          </div>

          <div class="price-table">
            <div class="price-row">
              <span class="size-badge">M</span>
              <span class="price-value" id="price-m">{{ formatVND(getPriceM(product)) }}₫</span>
              <span class="size-badge">L</span>
              <span class="price-value" id="price-l">{{ formatVND(getPriceL(product)) }}₫</span>
            </div>
            <div class="vip-row">
              <span class="size-badge vip">VIP</span>
              <span class="price-value" id="price-vip-m">{{ formatVND(getVipPriceM(product)) }}₫</span>
              <span class="size-badge vip">VIP</span>
              <span class="price-value" id="price-vip-l">{{ formatVND(getVipPriceL(product)) }}₫</span>
            </div>
          </div>

          <p class="desc" id="prod-desc">
            {{ product.description || product.detail || 'Sự kết hợp giữa trà ủ đậm và trái cây tạo nên hương vị hài hòa, phù hợp với nhiều sở thích.' }}
          </p>

          <div class="product-note">
            <button
              class="note-toggle"
              type="button"
              aria-expanded="false"
              aria-controls="product-note"
            >
              <span>Chú thích sản phẩm tại đây</span>
              <span class="note-icon" aria-hidden="true"></span>
            </button>
            <div class="note-content" id="product-note">
              <p id="note-text">{{ getNote() }}</p>
              <section class="custom-options" aria-label="Tùy chọn đồ uống">
                <div class="option-group">
                  <div class="group-title">Chọn kích cỡ</div>
                  <div class="pill-group" role="group" aria-label="Chọn kích cỡ">
                    <button class="pill" [class.active]="selectedSize === 'M'" type="button" data-size="M" (click)="selectSize('M')">
                      <span class="pill-label">M</span>
                      <span class="pill-sub" id="size-pill-m">{{ formatVND(getPriceM(product)) }}đ</span>
                    </button>
                    <button class="pill" [class.active]="selectedSize === 'L'" type="button" data-size="L" (click)="selectSize('L')">
                      <span class="pill-label">L</span>
                      <span class="pill-sub" id="size-pill-l">{{ formatVND(getPriceL(product)) }}đ</span>
                    </button>
                  </div>
                </div>

                <div class="option-group">
                  <div class="group-title">Độ ngọt</div>
                  <div class="pill-group" role="group" aria-label="Chọn độ ngọt" data-field="Ngọt">
                    <button class="pill active" type="button">Ít</button>
                    <button class="pill" type="button">Vừa</button>
                    <button class="pill" type="button">Nhiều</button>
                  </div>
                </div>

                <div class="option-group">
                  <div class="group-title">Đá</div>
                  <div class="pill-group" role="group" aria-label="Chọn lượng đá" data-field="Đá">
                    <button class="pill active" type="button">Ít</button>
                    <button class="pill" type="button">Vừa</button>
                    <button class="pill" type="button">Nhiều</button>
                  </div>
                </div>

                <div class="option-group topping-group">
                  <div class="group-title">Chọn topping</div>
                  <ul class="topping-list">
                    <li class="topping-row" data-price="3000">
                      <div class="topping-info">
                        <span class="topping-name">Sương sáo</span>
                        <span class="topping-price">3.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="suong-sao">
                        <button type="button" class="qty-minus" aria-label="Bớt Sương sáo">
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Sương sáo">
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="3000">
                      <div class="topping-info">
                        <span class="topping-name">Thạch dừa nguyên vị</span>
                        <span class="topping-price">3.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="thach-dua">
                        <button
                          type="button"
                          class="qty-minus"
                          aria-label="Bớt Thạch dừa nguyên vị"
                        >
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button
                          type="button"
                          class="qty-plus"
                          aria-label="Thêm Thạch dừa nguyên vị"
                        >
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="3000">
                      <div class="topping-info">
                        <span class="topping-name">Hạt é</span>
                        <span class="topping-price">3.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="hat-e">
                        <button type="button" class="qty-minus" aria-label="Bớt Hạt é">-</button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Hạt é">+</button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Thạch dứa hương đào</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="thach-dua-dao">
                        <button
                          type="button"
                          class="qty-minus"
                          aria-label="Bớt Thạch dứa hương đào"
                        >
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button
                          type="button"
                          class="qty-plus"
                          aria-label="Thêm Thạch dứa hương đào"
                        >
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Thạch aiyu</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="thach-aiyu">
                        <button type="button" class="qty-minus" aria-label="Bớt Thạch aiyu">
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Thạch aiyu">
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Thạch sợi lá dứa</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="thach-soi-la-dua">
                        <button type="button" class="qty-minus" aria-label="Bớt Thạch sợi lá dứa">
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Thạch sợi lá dứa">
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Thạch sương sáo viên (8)</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="thach-suong-sao-vien">
                        <button
                          type="button"
                          class="qty-minus"
                          aria-label="Bớt Thạch sương sáo viên"
                        >
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button
                          type="button"
                          class="qty-plus"
                          aria-label="Thêm Thạch sương sáo viên"
                        >
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Trân châu hoàng kim</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="tran-chau-hoang-kim">
                        <button
                          type="button"
                          class="qty-minus"
                          aria-label="Bớt Trân châu hoàng kim"
                        >
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button
                          type="button"
                          class="qty-plus"
                          aria-label="Thêm Trân châu hoàng kim"
                        >
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Trân châu đường đen</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="tran-chau-duong-den">
                        <button
                          type="button"
                          class="qty-minus"
                          aria-label="Bớt Trân châu đường đen"
                        >
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button
                          type="button"
                          class="qty-plus"
                          aria-label="Thêm Trân châu đường đen"
                        >
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Trân châu 3Q trắng/đen</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="tran-chau-3q">
                        <button type="button" class="qty-minus" aria-label="Bớt Trân châu 3Q">
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Trân châu 3Q">
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Trân châu khoai môn</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="tran-chau-khoai-mon">
                        <button
                          type="button"
                          class="qty-minus"
                          aria-label="Bớt Trân châu khoai môn"
                        >
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button
                          type="button"
                          class="qty-plus"
                          aria-label="Thêm Trân châu khoai môn"
                        >
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Hạt thủy tinh củ năng</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="hat-thuy-tinh-cu-nang">
                        <button
                          type="button"
                          class="qty-minus"
                          aria-label="Bớt Hạt thủy tinh củ năng"
                        >
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button
                          type="button"
                          class="qty-plus"
                          aria-label="Thêm Hạt thủy tinh củ năng"
                        >
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Hạt thủy tinh lúa mạch</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="hat-thuy-tinh-lua-mach">
                        <button
                          type="button"
                          class="qty-minus"
                          aria-label="Bớt Hạt thủy tinh lúa mạch"
                        >
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button
                          type="button"
                          class="qty-plus"
                          aria-label="Thêm Hạt thủy tinh lúa mạch"
                        >
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Đào miếng</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="dao-mieng">
                        <button type="button" class="qty-minus" aria-label="Bớt Đào miếng">
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Đào miếng">
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="5000">
                      <div class="topping-info">
                        <span class="topping-name">Khoai môn nghiền</span>
                        <span class="topping-price">5.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="khoai-mon-nghien">
                        <button type="button" class="qty-minus" aria-label="Bớt Khoai môn nghiền">
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Khoai môn nghiền">
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="7000">
                      <div class="topping-info">
                        <span class="topping-name">Hạt sen</span>
                        <span class="topping-price">7.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="hat-sen">
                        <button type="button" class="qty-minus" aria-label="Bớt Hạt sen">-</button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Hạt sen">+</button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="7000">
                      <div class="topping-info">
                        <span class="topping-name">Kem tươi vani</span>
                        <span class="topping-price">7.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="kem-tuoi-vani">
                        <button type="button" class="qty-minus" aria-label="Bớt Kem tươi vani">
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Kem tươi vani">
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="7000">
                      <div class="topping-info">
                        <span class="topping-name">Kem cheese</span>
                        <span class="topping-price">7.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="kem-cheese">
                        <button type="button" class="qty-minus" aria-label="Bớt Kem cheese">
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Kem cheese">
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="7000">
                      <div class="topping-info">
                        <span class="topping-name">Pudding trứng</span>
                        <span class="topping-price">7.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="pudding-trung">
                        <button type="button" class="qty-minus" aria-label="Bớt Pudding trứng">
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Pudding trứng">
                          +
                        </button>
                      </div>
                    </li>
                    <li class="topping-row" data-price="7000">
                      <div class="topping-info">
                        <span class="topping-name">Thạch sữa viên (8)</span>
                        <span class="topping-price">7.000đ</span>
                      </div>
                      <div class="topping-qty" data-topping="thach-sua-vien">
                        <button type="button" class="qty-minus" aria-label="Bớt Thạch sữa viên">
                          -
                        </button>
                        <span class="qty-value" aria-live="polite">0</span>
                        <button type="button" class="qty-plus" aria-label="Thêm Thạch sữa viên">
                          +
                        </button>
                      </div>
                    </li>
                  </ul>
                </div>
              </section>
            </div>
          </div>

          <div class="actions">
            <div class="actions">
              <div class="qty" aria-label="Số lượng">
                <button type="button" id="qty-minus" (click)="changeQty(-1)">-</button>
                <input
                  id="qty-input"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  [value]="qty"
                  aria-label="Số lượng"
                  readonly
                />
                <button type="button" id="qty-plus" (click)="changeQty(1)">+</button>
              </div>
              <button class="btn btn-outline" id="btn-add-cart" type="button" (click)="addToCart()">Thêm vào giỏ</button>
              <button class="btn btn-primary" id="btn-buy-now" type="button" (click)="buyNow()">Mua ngay</button>
            </div>
          </div>
        </div>
      </div>

      <div class="tabs">
        <button type="button" class="tab" [class.active]="activeTab === 'desc'" data-target="desc" (click)="setTab('desc')">Mô tả sản phẩm</button>
        <button type="button" class="tab" [class.active]="activeTab === 'review'" data-target="review" (click)="setTab('review')">Đánh giá</button>
        <button type="button" class="tab" [class.active]="activeTab === 'commit'" data-target="commit" (click)="setTab('commit')">Cam kết</button>
      </div>

      <section class="product-info-card tab-pane" [class.active]="activeTab === 'desc'" id="desc">
        <div class="info-header">
          <span class="info-icon">i</span>
          <span class="info-title">Thông tin chi tiết</span>
        </div>
        <div class="info-grid">
          <div class="info-row">
            <span class="label">Tên sản phẩm:</span> <span id="info-name">{{ product.name }}</span>
          </div>
          <div class="info-row">
            <span class="label">Bảo quản:</span>
            <span id="info-storage">{{ getStorage() }}</span>
          </div>
          <div class="info-row">
            <span class="label">Trọng lượng:</span>
            <span id="info-weight">{{ getWeight() }}</span>
          </div>
          <div class="info-row">
            <span class="label">Xuất xứ:</span> <span id="info-origin">{{ getOrigin() }}</span>
          </div>
          <div class="info-row full">
            <span class="label">Topping nên dùng kèm:</span>
            <span id="info-topping">{{ getTopping() }}</span>
          </div>
        </div>
      </section>

      <section class="review-block tab-pane" [class.active]="activeTab === 'review'" id="review">
        <div class="grid-2">
          <div class="col-left">
            <div class="score" id="score-value">{{ (product.rating ?? 5) | number:'1.1-1' }} <span class="unit">out of 5</span></div>
            <div class="stars" aria-label="Đánh giá" style="margin-top: 6px">
              <span class="fill" id="score-stars" [style.width.%]="ratingPct"></span>
            </div>
            <div class="count" id="score-count">({{ product.reviews ?? 0 }} lượt đánh giá)</div>
          </div>
          <div class="col-right">
            <div class="bar-row">
              <span>5 sao</span>
              <div class="bar"><span style="--val: 80%"></span></div>
            </div>
            <div class="bar-row">
              <span>4 sao</span>
              <div class="bar"><span style="--val: 70%"></span></div>
            </div>
            <div class="bar-row">
              <span>3 sao</span>
              <div class="bar"><span style="--val: 35%"></span></div>
            </div>
            <div class="bar-row">
              <span>2 sao</span>
              <div class="bar"><span style="--val: 15%"></span></div>
            </div>
            <div class="bar-row">
              <span>1 sao</span>
              <div class="bar"><span style="--val: 5%"></span></div>
            </div>
          </div>
        </div>

        <section class="review-section" aria-labelledby="reviews-title">
          <div class="review-header">
            <h3 class="reviews-title" id="reviews-title">Đánh giá sản phẩm</h3>
          </div>
          <div class="review">
            <img class="avatar" src="/assets/icons/user.png" alt="avatar" />
            <div>
              <div class="name">
                Hồng Hạnh <span class="stars"><span class="fill" style="width: 100%"></span></span>
              </div>
              <div class="title">Tôi yêu HTVT!!!!!!!</div>
              <div class="content">HTVT là thức uống ngon nhất, tôi có thể uống mỗi ngày!</div>
              <div class="review-actions">
                <button
                  type="button"
                  class="review-like"
                  aria-label="Thích đánh giá của Hồng Hạnh"
                >
                  <span class="icon" aria-hidden="true">♡</span>
                  Thích
                </button>
                <div class="review-stars-inline" aria-label="Đánh giá 5 trên 5">
                  <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
                </div>
              </div>
            </div>
            <div class="time">2 ngày trước</div>
          </div>
          <div class="review">
            <img class="avatar" src="/assets/icons/user.png" alt="avatar" />
            <div>
              <div class="name">
                Bảo Vy <span class="stars"><span class="fill" style="width: 100%"></span></span>
              </div>
              <div class="title">So good, so yummy</div>
              <div class="content">HTVT rất ngon, tuyệt vời!</div>
              <div class="review-actions">
                <button
                  type="button"
                  class="review-like"
                  aria-label="Thích đánh giá của Bảo Vy"
                >
                  <span class="icon" aria-hidden="true">♡</span>
                  Thích
                </button>
                <div class="review-stars-inline" aria-label="Đánh giá 5 trên 5">
                  <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
                </div>
              </div>
            </div>
            <div class="time">3 ngày trước</div>
          </div>
          <div class="review-pagination" role="navigation" aria-label="Trang đánh giá">
            <button type="button" class="page-btn icon-btn" aria-label="Trang trước">‹</button>
            <button type="button" class="page-btn active">1</button>
            <button type="button" class="page-btn">2</button>
            <button type="button" class="page-btn">3</button>
            <button type="button" class="page-btn">4</button>
            <span class="page-dots" aria-hidden="true">...</span>
            <button type="button" class="page-btn">10</button>
            <button type="button" class="page-btn icon-btn" aria-label="Trang sau">›</button>
          </div>
          <form class="review-form" action="#" method="post" aria-label="Gửi đánh giá sản phẩm">
            <div class="rating-field">
              <span class="label">Chất lượng sản phẩm:</span>
            </div>
            <textarea
              name="note"
              rows="3"
              placeholder="Hãy để lại nhận xét cho sản phẩm này bạn nhé! Ngô Gia xin chân thành cảm ơn."
            ></textarea>
            <div class="form-actions">
              <button type="button" class="btn btn-primary submit-review">Đánh giá</button>
            </div>
          </form>
        </section>
      </section>

      <section class="commitment tab-pane" [class.active]="activeTab === 'commit'" id="commit" aria-label="Cam kết">
        <h3>Cam kết chất lượng</h3>
        <ul class="commit-list">
          <li>
            <span class="commit-icon" aria-hidden="true"></span>
            Lá trà được chọn lọc kỹ lưỡng từ vùng núi cao,<strong
              >không phẩm màu – không hương liệu tổng hợp</strong
            >, giữ trọn vị trà nguyên bản.
          </li>
          <li>
            <span class="commit-icon" aria-hidden="true"></span>
            Mỗi mẻ trà đều được sao, ủ và lên hương theo<strong>bí quyết gia truyền</strong>, đảm
            bảo hương thơm đậm đà, vị hậu ngọt tinh tế.
          </li>
          <li>
            <span class="commit-icon" aria-hidden="true"></span>
            Mọi sản phẩm được<strong>đóng gói kín, bảo quản đúng chuẩn</strong>, đảm bảo hương vị
            luôn tươi mới khi đến tay khách hàng.
          </li>
          <li>
            <span class="commit-icon" aria-hidden="true"></span>
            Hồng Trà Ngô Gia luôn lắng nghe phản hồi và<strong
              >đổi trả nếu sản phẩm không đạt chất lượng cam kết</strong
            >, mang đến trải nghiệm đáng tin cậy.
          </li>
        </ul>
      </section>

      <section class="related-section" id="related">
        <h3 class="related-title">Có thể bạn sẽ thích</h3>
        <div class="menu-grid" id="related-list">
          <article *ngFor="let p of relatedProducts" class="menu-card"
                   tabindex="0" role="link"
                   [attr.aria-label]="'Xem chi tiết ' + p.name"
                   (click)="goToProduct(p)"
                   (keydown.enter)="goToProduct(p)"
                   (keydown.space)="$event.preventDefault(); goToProduct(p)">
            <figure>
              <img [src]="getProductImg(p)" [alt]="p.name" />
            </figure>
            <div class="card-body">
              <div class="card-meta">
                <span class="star">★</span>
                <span>{{ (p.rating ?? 5) | number:'1.1-1' }}</span>
                <span>•</span>
                <span>{{ p.reviews ?? 0 }} lượt đánh giá</span>
              </div>
              <h3>{{ p.name }}</h3>
              <div class="price-row">
                <div class="price-col">
                  <div class="line size-line">
                    <span class="label">M</span>
                    <span class="value">{{ formatVND(getPriceM(p)) }}đ</span>
                  </div>
                  <div class="line vip-line">
                    <span class="label vip">VIP</span>
                    <span class="value">{{ formatVND(getVipPriceM(p)) }}đ</span>
                  </div>
                </div>
                <div class="price-col">
                  <div class="line size-line">
                    <span class="label">L</span>
                    <span class="value">{{ formatVND(getPriceL(p)) }}đ</span>
                  </div>
                  <div class="line vip-line">
                    <span class="label vip">VIP</span>
                    <span class="value">{{ formatVND(getVipPriceL(p)) }}đ</span>
                  </div>
                </div>
                <button class="price-cart" type="button" [attr.aria-label]="'Thêm vào giỏ ' + p.name"
                        (click)="addRelatedToCart($event, p)">
                  <img src="assets/icons/Cart2.png" alt="" aria-hidden="true" />
                </button>
              </div>
            </div>
          </article>
        </div>
      </section>
    </section>
  </div>
</main>
